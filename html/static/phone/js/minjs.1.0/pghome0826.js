$(function(){FastClick.attach(document.body)});var base={ajax:function(e){$.ajax({url:"/rest",type:"POST",dataType:"json",async:e.async?e.async:!1,data:{data:JSON.stringify(e.data)},success:function(t){e.success&&e.success(t)},error:function(t){e.error&&e.error(t)}})},parseDom:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].textContent},renderTime:function(e){var t=new Date,a=e.split(" "),i=a[0].split("-"),n=a[1].split(":");t.setFullYear(i[0],i[1]-1,i[2]),t.setHours(n[0],n[1],n[2],0);var s=t.getTime(),o=new Date,p=o.getTime(),r=p-s,l=[t.getFullYear(),t.getMonth(),t.getDate()],c=[o.getFullYear(),o.getMonth(),o.getDate()];if(6e4>r)return"刚刚";if(r>=6e4&&36e5>r){var g=parseInt(r/6e4);return g+"分钟前"}if(r>=36e5&&216e5>r){var g=parseInt(r/36e5);return g+"小时前"}if(r>=216e5&&l==c)return"今天"+t.getHours()+":"+t.getMinutes();if(r>=216e5&&l[0]==c[0]&&l[1]==c[1]&&c[2]-l[2]==1)return"昨天"+t.getHours()+":"+t.getMinutes();var d=t.getMonth()+1;return t.getFullYear()+"/"+d+"/"+t.getDate()}};$(function(){function e(){var e=document.documentElement.clientWidth,t=document.getElementsByTagName("html")[0],a=document.getElementsByTagName("body")[0];500>e?(e=parseInt(e/8),t.style.fontSize=e+"px",a.style.fontSize=e+"px"):e>=500&&(e=500,e=parseInt(e/8),t.style.fontSize=e+"px",a.style.fontSize=e+"px")}function t(){var e=$(".photos-list img").css("width");$(".photos-list img").css("height",e)}e(),t(),window.addEventListener("resize",function(){e(),t()},!1)}),$(function(){$(".column").tap(function(){$(".nav").animate({"-webkit-transform":"translate3d(0,100%,0)",transform:"translate3d(0,100%,0)",opacity:"1"},"cubic-bezier(0.1,0.57,0.1,1)",800,function(){$(".top-bar").css("display","none")})}),$(".shrink").tap(function(){$(".top-bar").css("display","block"),$(".nav").animate({"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)",opacity:"0"},"cubic-bezier(0.1,0.57,0.1,1)",800)})}),$(".pg_info li").tap(function(){0==$(".pg_info li").index($(this))?($(".pg_border").animate({"-webkit-transform":"translate3d(0,0,0)"},200),$(".pg_album").show(),$(".pg_msg").hide(),$(this).addClass("pg-info-cur").siblings().removeClass("pg-info-cur")):2==$(".pg_info li").index($(this))&&($(".pg_border").animate({"-webkit-transform":"translate3d(1.61rem,0,0)"},200),$(".pg_album").hide(),$(".pg_msg").show(),$(this).addClass("pg-info-cur").siblings().removeClass("pg-info-cur"))}),$(".ifspread").tap(function(){"none"==$(this).parent("div").find(".spread-main").css("display")?($(this).parent("div").find(".spread-main").css({display:"block"}),$(this).animate({"-webkit-transform":"rotate(0)",transform:"rotate(0)"},200)):($(this).parent("div").find(".spread-main").css({display:"none"}),$(this).animate({"-webkit-transform":"rotate(180deg)",transform:"rotate(180deg)"},200))});var pghome={host:null,pg_id:0,albumPageNo:1,feedPageNo:1,count:0,b_load:!0,load_end:!0,get_host_name:function(){var e=window.location.href,t=e.lastIndexOf("/")+1;if(-1!=e.lastIndexOf("?")){var a=e.lastIndexOf("?");host_name=e.substring(t,a)}else host_name=e.substring(t);return host_name},get_img_h:function(){var e=$('<div class="pg_album_list"><a href="javascript:;"><img src="/static/phone/images/photo3.jpg"><h4></h4><i></i></a></div>').appendTo(".pg_album"),t=e.find("img").get(0).scrollWidth;return e.remove(),t},is_avatar:function(e){var t="";return t="0"==e?"/static/phone/images/user_head.gif":"http://image.paiwo.co/"+e},put_tag:function(e){var t=0;t=e.length>5?4:e.length;for(var a='<span>"</span>',i=0;t>i;i++)a+=i==t-1?"<span>"+e[i].tag_word+"</span>":"<span>"+e[i].tag_word+"</span><i>|</i>";return a+='<span>"</span>'},is_sex:function(e){return"1"==e?"boy":"2"==e?"girl":"nosex"},put_gender:function(e){return 1==e?"男":2==e?"女":void 0},put_banner:function(e){return e?"url(http://image.paiwo.co/"+e+")":"url(/static/images/bg.jpg)"},put_brith:function(e){if(""!=e){var t=e.split("-"),a=""+t[0]+"年"+t[1]+"月"+t[2]+"日",i="<li><span>生日/</span><i>"+a+"</i></li>";return i}},pg_info:function(e){base.ajax({data:{method:"paiwo.home.get",host_domain:pghome.host},success:function(e){if(0==e.error_id){var t=e.response,a=document.querySelector(".photog_avatar"),i=(document.querySelector(".photog_key"),document.querySelector(".photog_nick")),n=document.querySelector(".photog_over"),s=document.querySelector(".count_coll"),o=document.querySelector(".count_like"),p=(document.querySelector(".pg_album"),document.querySelector("#pg_intro")),r=(document.querySelector("#pg_contact"),document.querySelector(".photo_type")),l=document.querySelector(".photo_address"),c={};pghome.pg_id=t.photographer_id,pghome.count=t.album_count,c.desc=t.host_desc,c.host=t.host_domain,c.gender=t.gift,tabSwitch.html(0==t.gift?'<span class="pg-cla-line" style="width:50%;"></span><ul><li class="feed pg-cla-cur" style="width:50%;">主页</li><li class="info" style="width:50%;">简介</li></ul>':'<span class="pg-cla-line"></span><ul><li class="feed pg-cla-cur">主页</li><li class="album">相册</li><li class="info">简介</li></ul>'),a.setAttribute("src",pghome.is_avatar(t.host_avatar)),i.innerHTML=t.host_name,n.style.backgroundImage=pghome.put_banner(t.banner_photo),s.innerHTML="<i></i>"+t.favorite_count,o.innerHTML="<i></i>"+t.like_count,p.innerHTML=pghome.put_intro(c),r.innerHTML=pghome.services_type(t.photograph_type),l.innerHTML=pghome.put_take_location(t.photograph_address)}},error:function(e){}})},get_album_list:function(e){base.ajax({async:!0,data:{method:"paiwo.content.album_list.get",host_domain:e,page_no:pghome.albumPageNo,page_size:6},success:function(e){if(0==e.error_id){var t=e.response,a=e.response.album_list,i="";t.page_no*t.page_size>=t.count?pgAlbum.find(".more-album").hide():pgAlbum.find(".more-album").show();for(var n=0;n<a.length;n++)i+='<div class="pg_album_list" data-code="'+a[n].album_id+'"><a href="/album/'+a[n].album_id+'" class="img-a"><img height="" src="http://image.paiwo.co/'+a[n].cover_path+'@!560x560"></a><a href="/album/'+a[n].album_id+'"><div class="bottom-tit"><h4>'+a[n].album_name+"</h4><i>"+a[n].photo_count+"</i></div></a></div>";pgAlbum.find(".pg_album_main").append(i)}},error:function(e){}})},get_feed_list:function(e){base.ajax({data:{method:"paiwo.content.dynamic_list.get",host_domain:e,page_no:pghome.feedPageNo,page_size:4},success:function(e){if(0==e.error_id){var t=e.response,a=t.content_list,i="",n=pgFeed.find(".pg_all_main");0==t.count&&(i='<div class="pg_all_type pg_recphoto"><div class="pg_pocket_main" style="background-image:url(/static/images/cute_bac/no_fans2.jpg);background-size: 80%;top:-40px;"><div class="pg_pocket_tit" style="height:30px;"><h3></h3><h4 style="color:#8a8880;">这个人很聪明，什么都没有留下</h4></div></div></div>'),t.page_no*t.page_size>=t.count?pgFeed.find(".more-feed").hide():pgFeed.find(".more-feed").show();for(var s=0;s<a.length;s++)switch(a[s].content_type){case 1:var o="";1==a[s].photo_list.length&&(o="pg_pubalbum_one"),i+='<div class="pg_all_type pg_pubalbum" data-code="'+a[s].content_id+'"><p class="pg_all_top"><span class="pg_all_tit">发布了影集</span><a class="pg_album_name" href="/album/'+a[s].content_id+'">'+a[s].content_title+'</a><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_pubalbum_main '+o+'">'+pghome.put_feed_cover(a[s].photo_list)+"</div></div>";break;case 2:i+='<div class="pg_all_type pg_recpocket" data-code="'+a[s].content_id+'"><p class="pg_all_top"><span class="pg_all_tit">发布了图文</span><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_pocket_main" style="background-image:url(http://image.paiwo.co/'+a[s].photo_list[0].photo_path+'@!1d5)"><a href="/pocket/'+a[s].content_id+'"><div class="pg_all_shadow"></div><div class="pg_pocket_tit"><h3>'+a[s].content_title+"</h3><h4>"+a[s].content_desc+"</h4></div></a></div></div>";break;case 5:i+=a[s].is_delete?'<div class="pg_all_type pg_recphoto"><p class="pg_all_top"><span class="pg_all_tit">推荐了照片</span><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_pocket_main" style="background-image:url(/static/images/cute_bac/delete.png);background-size: 66%;"><div class="pg_pocket_tit" style="height:30px;"><h3></h3><h4 style="color:#8a8880;">原内容已被删除</h4></div></div></div>':'<div class="pg_all_type pg_recphoto"><p class="pg_all_top"><span class="pg_all_tit">推荐了照片</span><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_photo_main"><a href="/photos/'+a[s].content_id+'"><img src="http://image.paiwo.co/'+a[s].photo_list[0].photo_path+'@!600x600"></a></div><p class="pg_all_author"><span>原作者</span><span>|</span><span><a href="/'+a[s].content_author_domain+'">'+a[s].content_author_name+"</a></span></p></div>";break;case 6:i+=a[s].is_delete?'<div class="pg_all_type pg_recpocket"><p class="pg_all_top"><span class="pg_all_tit">推荐了图文</span><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_pocket_main" style="background-image:url(/static/images/cute_bac/delete.png);background-size: 66%;"><div class="pg_pocket_tit" style="height:30px;"><h3></h3><h4 style="color:#8a8880;">原内容已被删除</h4></div></div></div>':'<div class="pg_all_type pg_recpocket"><p class="pg_all_top"><span class="pg_all_tit">推荐了图文</span><span class="pg_all_time">'+base.renderTime(a[s].create_time)+'</span></p><div class="pg_pocket_main" style="background-image:url(http://image.paiwo.co/'+a[s].photo_list[0].photo_path+'@!1d5)"><a href="/pocket/'+a[s].content_id+'"><div class="pg_all_shadow"></div><div class="pg_pocket_tit"><h3>'+a[s].content_title+"</h3><h4>"+a[s].content_desc+'</h4></div></a></div><p class="pg_all_author"><span>原作者</span><span>|</span><span class="pg_author_name"><a href="/'+a[s].content_author_domain+'">'+a[s].content_author_name+"</a></span></p></div>";break;default:i+=""}n.append(i)}},error:function(e){}})},put_feed_cover:function(e){for(var t="",a="",i="",n=e.length>4?4:e.length,s=0;n>s;s++)e[s].is_cover?a='<a href="/photos/'+e[s].photo_id+'"><img src="http://image.paiwo.co/'+e[s].photo_path+'@!600x600"></a>':i+='<li><a href="/photos/'+e[s].photo_id+'"><img src="http://image.paiwo.co/'+e[s].photo_path+'@!280x280"></a></li>';return t+='<div class="pg_pubalbum_cover">'+a+'</div><ul class="pg_pubalbum_img">'+i+"</ul>"},put_intro:function(e){var t="";return""!=e.desc&&(t+='<li class="pg_info_desc"><span>描述/</span><p>'+e.desc+"</p></li>"),""!=e.host&&(t+="<li><span>个性域名/</span><em>paiwo.co/"+e.host+"</em></li>"),""!=e.gender&&(t+="<li><span>性别/</span><i>"+pghome.put_gender(e.gender)+"</i></li>"),t},put_contact:function(e){var t="";return""!=e.phone&&(t+="<li><span>手机号码/</span><i>"+e.phone+"</i></li>"),e.qq&&(t+="<li><span>QQ/</span><i>"+e.qq+"</i></li>"),e.wechat&&(t+="<li><span>微信/</span><i>"+e.wechat+"</i></li>"),e.weibo&&(t+="<li><span>微博/</span><i>"+e.weibo+"</i></li>"),t},services_type:function(e){var t="<dt>—— 接拍类型 ——</dt>",a=e.toString(2).split("").reverse(),i=["人像写真","婚纱摄影","婚礼跟拍","家庭儿童","旅行跟拍","商业服务","其他"];if(1==a.length&&"0"===a[0].toString())t+="<dd>无</dd>";else for(var n=0;n<a.length;n++)1==a[n]&&(t+="<dd>"+i[n]+"</dd>");return t},put_take_location:function(e){function t(e){var t=e.substring(0,2),a=e.substring(0,5)+"-00-00";if("01"==t){if("01-00-00-00"==e)return"海外";var i=allArea.province["01-00-00-00"];for(var n in i)if(n==e)return i[n]}else if("02"==t){if("02-00-00-00"==e)return"中国全境";var s=allArea.province["02-00-00-00"],o=e.substring(6);if("00-00"==o){for(var n in s)if(n==e)return s[n]}else{var p=e.substring(0,8)+"-00";for(var n in s)if(n==a){var r=allArea.city[a];for(var n in r){if(n==p)return r[n];var l=allArea.district[p];for(var n in l)if(n==e)return l[n]}}}}}var a="<dt>—— 接拍地 ——</dt>";if(e.length)for(var i=0;i<e.length;i++)a+="<dd>"+t(e[i])+"</dd>";else a+="<dd>无</dd>";return a}},pgFeed=$(".pg_all"),pgAlbum=$(".pg_album"),pgInfo=$(".pg_msg"),tabSwitch=$(".pg-classify");!function(){pghome.host=pghome.get_host_name(),pghome.pg_info(),pghome.get_album_list(pghome.host),pghome.get_feed_list(pghome.host)}(),tabSwitch.on("tap","li",function(){var e=$(this),t=$(".pg-classify li").index(e),a=100*t;if($(".pg-cla-line").css({"-webkit-transform":"translate3d("+a+"%,0,0)",transform:"translate3d("+a+"%,0,0)"}),e.hasClass("feed"))pgFeed.show(),pgAlbum.hide(),pgInfo.hide();else if(e.hasClass("album"))pgFeed.hide(),pgAlbum.show(),pgInfo.hide();else{if(!e.hasClass("info"))return;pgFeed.hide(),pgAlbum.hide(),pgInfo.show()}}),pgFeed.on("tap",".more-feed",function(){pghome.feedPageNo++,pghome.get_feed_list(pghome.host)}),pgAlbum.on("tap",".more-album",function(){pghome.albumPageNo++,pghome.get_album_list(pghome.host)});